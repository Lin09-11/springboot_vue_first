# 一、基本的页面样式

```vue
<template>
    <el-container style="height: 100vh">

<!--      侧边栏
          :width：动态绑定宽度，使得侧边栏可以收缩
-->
      <el-aside :width="sideWidth+'px'" style="background-color: rgb(238, 241, 246); height:100%; box-shadow: 2px 0 6px rgb(0 21 41)" >
<!--        :collapse-transition="false":取消导航栏动画收缩
            :collapse="isCollapse":侧边栏是否折叠
-->
        <el-menu :default-openeds="['1', '3']" style="min-height: 100%; overflow: hidden"
                 background-color="rgb(48,65,86)"
                 text-color="#fff"
                 active-text-color="#ffd04b"
                 :collapse-transition="false"
                 :collapse="isCollapse"
        >
          <div style="height: 60px;line-height: 60px; text-align: center">
            <img src="../assets/logo.png" alt="" style="width: 20px; position: relative;top: 5px;margin-right: 5px">
            <b style="color:white" v-show="logoTextShow">后台管理系统</b>
          </div>
          <el-submenu index="1">
            <template slot="title">
              <i class="el-icon-location"></i>
              <span slot="title">导航一</span>
            </template>
            <el-menu-item-group>
              <template slot="title">分组一</template>
              <el-menu-item index="1-1">选项1</el-menu-item>
              <el-menu-item index="1-2">选项2</el-menu-item>
            </el-menu-item-group>
            <el-menu-item-group title="分组2">
              <el-menu-item index="1-3">选项3</el-menu-item>
            </el-menu-item-group>
            <el-submenu index="1-4">
              <template slot="title">选项4</template>
              <el-menu-item index="1-4-1">选项4-1</el-menu-item>
            </el-submenu>
          </el-submenu>
          <el-submenu index="2">
            <template slot="title">
              <i class="el-icon-menu"></i>
              <span slot="title">导航二</span>
            </template>
            <el-menu-item-group>
              <template slot="title">分组一</template>
              <el-menu-item index="2-1">选项1</el-menu-item>
              <el-menu-item index="2-2">选项2</el-menu-item>
            </el-menu-item-group>
            <el-menu-item-group title="分组2">
              <el-menu-item index="2-3">选项3</el-menu-item>
            </el-menu-item-group>
            <el-submenu index="2-4">
              <template slot="title">选项4</template>
              <el-menu-item index="2-4-1">选项4-1</el-menu-item>
            </el-submenu>
          </el-submenu>
          <el-submenu index="3">
            <template slot="title">
              <i class="el-icon-setting"></i>
              <span slot="title">导航三</span>
            </template>
            <el-menu-item-group>
              <template slot="title">分组一</template>
              <el-menu-item index="3-1">选项1</el-menu-item>
              <el-menu-item index="3-2">选项2</el-menu-item>
            </el-menu-item-group>
            <el-menu-item-group title="分组2">
              <el-menu-item index="3-3">选项3</el-menu-item>
            </el-menu-item-group>
            <el-submenu index="3-4">
              <template slot="title">选项4</template>
              <el-menu-item index="3-4-1">选项4-1</el-menu-item>
            </el-submenu>
          </el-submenu>
        </el-menu>
      </el-aside>





      <el-container>
<!--        信息头部-->
<!--        line-height:让其与高度一致，可以使得文字水平居中-->
        <el-header style="font-size: 12px; border: 1px solid #ccc; line-height: 60px; display: flex">
          <div style="flex: 1;font-size: 18px">
<!--            给span动态绑定一个“collapseBtnClass”类，收缩框
                并添加一个点击事件
-->
            <span :class="collapseBtnClass" style="cursor: pointer" @click="collapse"></span>
          </div>
          <el-dropdown  style="width: 50px;cursor: pointer">
            <span>王小虎</span><i class="el-icon-arrow-down" style="margin-left: 5px"></i>
            <el-dropdown-menu slot="dropdown">
              <el-dropdown-item>个人信息</el-dropdown-item>
              <el-dropdown-item>退出</el-dropdown-item>
            </el-dropdown-menu>
          </el-dropdown>
        </el-header>

<!--        信息主体-->
        <el-main>
<!--          搜索框-->
          <div style="padding: 10px 0">
            <el-input style="width: 200px" suffix-icon="el-icon-search"></el-input>
            <el-button style="margin-left: 5px" type="primary">搜索</el-button>
          </div>
          <el-table :data="tableData">
            <el-table-column prop="date" label="日期" width="140">
            </el-table-column>
            <el-table-column prop="name" label="姓名" width="120">
            </el-table-column>
            <el-table-column prop="address" label="地址">
            </el-table-column>
          </el-table>

<!--          下方的分页-->
          <div style="padding: 10px 0">
            <el-pagination
                :page-sizes="[5, 10, 15, 20]"
                :page-size="10"
                layout="total, sizes, prev, pager, next, jumper"
                :total="400">
            </el-pagination>
          </div>
        </el-main>
      </el-container>
    </el-container>
</template>

<script>

export default {
  name: 'HomeView',
  data(){
    const item = {
      date: '2016-05-02',
      name: '王小虎',
      address: '上海市普陀区金沙江路 1518 弄'
    };
    return {
      msg: "您好",
      tableData: Array(10).fill(item),
      collapseBtnClass: 'el-icon-s-fold',
      //侧边栏默认是展开的
      isCollapse: false,
      //默认值是200px
      sideWidth:200,
      logoTextShow:true
    };
  },
  methods:{
    collapse(){//点击收缩按钮触发
      this.isCollapse=!this.isCollapse
      if(this.isCollapse){
        this.sideWidth=64
        //修改图标
        this.collapseBtnClass='el-icon-s-unfold'
        //文字是否消失
        this.logoTextShow=false
      }else {
        this.sideWidth=200
        this.collapseBtnClass='el-icon-s-fold'
        this.logoTextShow=true
      }
    }
  }
}
</script>
```

# 二、动态sql

1.在使用update时候，是将整个用户的数据进行修改,所以我们要使用修改部分数据即可。故要使用mybatis的xml映射文件

地址：[入门_MyBatis中文网](https://mybatis.net.cn/getting-started.html)

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.mybatis.example.BlogMapper">
```

2.Usermapper.xml与UserMapper.java进行映射

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace:是要进行映射的mapper文件的地址-->
<mapper namespace="com.xiaolin.springboot.mapper.UserMapper">
<!--     id：要与映射的mapper文件中使用其方法的名字一致-->
    <update id="update">
        update sys_user
        <set>
            <if test="username !=null">
                username=#{username},
            </if>
            <if test="password !=null">
                password=#{password},
            </if>
            <if test="nickname !=null">
                nickname=#{nickname},
            </if>
            <if test="email !=null">
                email=#{email},
            </if>
            <if test="phone !=null">
                phone=#{phone},
            </if>
            <if test="address !=null">
                address=#{address}
            </if>
        </set>
    <where>
        id=#{id}
    </where>
    </update>
</mapper>

```

```java
package com.xiaolin.springboot.mapper;

import com.xiaolin.springboot.entity.User;
import org.apache.ibatis.annotations.Insert;
import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Select;
import org.apache.ibatis.annotations.Update;

import java.util.List;

/**
 * 用于数据库连接
 */
@Mapper
public interface UserMapper {

    /**
     * 更新用户信息
     * @param user
     */
    Integer update(User user);
}

```

# 三、将Mapper的配置信息加入到SpringBoot的配置文件中,并打印日志信息

```xml
#扫描所有的mybatis的xml文件
mybatis:
  mapper-locations: classpath:mapper/*.xml
  configuration:
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
```

![image-20230726204217719](D:\SpringBoot+Vue\assets\image-20230726204217719.png)

# 四、SpringBoot的增删改查

### UserController

```java
@RestController
@RequestMapping("/user")//将该文件要进行访问时候，统一地址为“user”
public class UserController {

    @Autowired//导入UserMapper的实例对象
    private UserMapper userMapper;

    @Autowired
    private UserService userService;

    @PostMapping()
    /**
     * 新增和修改
     * @RequestBody:是将用户传入的数据转换为json对象
     */
    public Integer save(@RequestBody User user){
//        return userMapper.insert(user);
        return userService.save(user);
    }


    /**
     * 查询全部信息
     * @return
     */
    @GetMapping("/")
    public List<User> index(){
        return userMapper.findAll();
    }

    /**
     * 根据传入的id删除信息
     * @PathVariable:是获取用户输入的数据
     */
    @DeleteMapping("/{id}")
    public Integer delete(@PathVariable Integer id){
        return userMapper.deleteById(id);
    }
}
```

### UserMapper

```java
/**
 * 用于数据库连接
 */
@Mapper
public interface UserMapper {
    /**
     * 查询全部用户
     * @return
     */
    @Select("select * from sys_user;")
    public List<User> findAll();

    /**
     * 实现用户的插入
     * @param user
     * @return
     */
    @Insert("insert into sys_user(username, password, nickname, email, phone, address) VALUES\n" +
            "    (#{username},#{password},#{nickname},#{email},#{phone},#{address});")
    Integer insert(User user);

    /**
     * 更新用户信息
     * @param user
     */
    Integer update(User user);

    /**
     *  @Param("id")中的”id“要与where id中的传参id形式要一致的
     * @param id
     * @return
     */
    @Delete("delete from sys_user where id=#{id}")
    Integer deleteById(@Param("id") Integer id);
}
```

### UserService

```java
@Service//将实例对象交给IOC容器
public class UserService {
    @Autowired
    private UserMapper userMapper;

    public int save(User user){
        if(user.getId()==null){//user没有id，则表示新增加
           return userMapper.insert(user);
        }else {//user有id，表示更新
            return userMapper.update(user);
        }
    }
}
```

### resources/mapper/User.xml

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace:是要进行映射的mapper文件的地址-->
<mapper namespace="com.xiaolin.springboot.mapper.UserMapper">
<!--     id：要与映射的mapper文件中使用其方法的名字一致-->
    <update id="update">
        update sys_user
        <set>
            <if test="username !=null">
                username=#{username},
            </if>
            <if test="password !=null">
                password=#{password},
            </if>
            <if test="nickname !=null">
                nickname=#{nickname},
            </if>
            <if test="email !=null">
                email=#{email},
            </if>
            <if test="phone !=null">
                phone=#{phone},
            </if>
            <if test="address !=null">
                address=#{address}
            </if>
        </set>
    <where>
        id=#{id}
    </where>
    </update>
</mapper>

```

# 五、跨域问题

![image-20230726213609866](D:\SpringBoot+Vue\assets\image-20230726213609866.png)

### 1.概念

**跨域：协议，ip，端口号这三个只要有一个不同就发生了跨域**

### 2.解决方法

```java
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.cors.CorsConfiguration;
import org.springframework.web.cors.UrlBasedCorsConfigurationSource;
import org.springframework.web.filter.CorsFilter;
 
@Configuration
public class CorsConfig {
 
    // 当前跨域请求最大有效时长。这里默认1天
    private static final long MAX_AGE = 24 * 60 * 60;
 
    @Bean
    public CorsFilter corsFilter() {
        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();
        CorsConfiguration corsConfiguration = new CorsConfiguration();
        corsConfiguration.addAllowedOrigin("*"); // 1 设置访问源地址
        corsConfiguration.addAllowedHeader("*"); // 2 设置访问源请求头
        corsConfiguration.addAllowedMethod("*"); // 3 设置访问源请求方法
        corsConfiguration.setMaxAge(MAX_AGE);
        source.registerCorsConfiguration("/**", corsConfiguration); // 4 对接口配置跨域设置
        return new CorsFilter(source);
    }
}

```

# 六、SpringBoot分页查询

### 1.忽略某一个字段，不展示给前端

![image-20230726214745458](D:\SpringBoot+Vue\assets\image-20230726214745458.png)

```
@JsonIgnore
```

### 2.使用fetch

#### UserController

```java
@RestController
@RequestMapping("/user")//将该文件要进行访问时候，统一地址为“user”
public class UserController {

    @Autowired//导入UserMapper的实例对象
    private UserMapper userMapper;

    @Autowired
    private UserService userService;

    //分页查询
    //接口路径 ：/user/page?pageNum=1&pageSize=10
    /**
     * @RequestParam:是将输入的数据分别进行映射【pageNum=1 pageSize=10】
     * @param pageNum
     * @param pageSize
     * @return
     * limit第一个参数=（pageNum-1） * pageSize
     * limit第二个参数
     */
    @GetMapping("/page")
    public Map<String, Object> findPage(@RequestParam Integer pageNum, @RequestParam Integer pageSize){
        pageNum=(pageNum-1)*pageSize;
        //data是渲染出来的数据
        List<User> data = userMapper.selectPage(pageNum, pageSize);
        //查询总条数
        Integer total = userMapper.selectTotal();
        //封装成一个Map对象
        Map<String,Object> res=new HashMap<>();
        res.put("data",data);
        res.put("total",total);
        return res;
    }

}
```

#### UserMapper

```java
/**
 * 用于数据库连接
 */
@Mapper
public interface UserMapper {

    /**
     * SpringBoot实现分页查询的基本原理
     * @param pageNum
     * @param pageSize
     * @return
     */
    @Select("select * from sys_user limit #{pageNum} ,#{pageSize};")
    List<User> selectPage(Integer pageNum, Integer pageSize);

    /**
     * 查看总条数
     * @return
     */
    @Select("select count(*) from sys_user;")
    Integer selectTotal();
}
```

#### HomeView.vue

![image-20230726222825738](D:\SpringBoot+Vue\assets\image-20230726222825738.png)

![image-20230726223035231](D:\SpringBoot+Vue\assets\image-20230726223035231.png)

![image-20230726223108538](D:\SpringBoot+Vue\assets\image-20230726223108538.png)

![image-20230726223133105](D:\SpringBoot+Vue\assets\image-20230726223133105.png)

```vue
          <el-table :data="tableData" border stripe>
            <el-table-column prop="id" label="ID" width="80"></el-table-column>
            <el-table-column prop="username" label="用户名" width="140"></el-table-column>
            <el-table-column prop="nickname" label="昵称" width="120"></el-table-column>
            <el-table-column prop="email" label="邮箱"></el-table-column>
            <el-table-column prop="phone" label="电话"></el-table-column>
            <el-table-column prop="address" label="地址"></el-table-column>
            <el-table-column label="操作">
                <template slot-scope="scope">
                  <el-button type="success">编辑<i class="el-icon-edit"></i></el-button>
                  <el-button type="danger">删除<i class="el-icon-remove-outline"></i></el-button>
                </template>
            </el-table-column>
          </el-table>
          


<!--          下方的分页-->
          <div style="padding: 10px 0">
<!--            current-page:当前的页数-->
            <el-pagination
                @size-change="handleSizeChange"
                @current-change="handleCurrentChange"
                :current-page="pageNum"
                :page-sizes="[2, 5, 10, 20]"
                :page-size="pageSize"
                layout="total, sizes, prev, pager, next, jumper"
                :total="total">
            </el-pagination>
          </div>
        </el-main>
      </el-container>
    </el-container>
</template>

<script>

export default {
  name: 'HomeView',
  data(){
    return {
      msg: "您好",
      tableData: [],
      collapseBtnClass: 'el-icon-s-fold',
      //侧边栏默认是展开的
      isCollapse: false,
      //默认值是200px
      sideWidth:200,
      logoTextShow:true,
      //数据的条数
      total:0,
      //当前页数
      pageNum:1,
      //一页展示的条数
      pageSize:2,
    };
  },
  created() {
    //请求分页查询数据
    this.load();
  },
  methods:{
    collapse(){//点击收缩按钮触发
      this.isCollapse=!this.isCollapse
      if(this.isCollapse){
        this.sideWidth=64
        //修改图标
        this.collapseBtnClass='el-icon-s-unfold'
        //文字是否消失
        this.logoTextShow=false
      }else {
        this.sideWidth=200
        this.collapseBtnClass='el-icon-s-fold'
        this.logoTextShow=true
      }
    },
    //进行数据的请求
    load(){
      fetch("http://localhost:9090/user/page?pageNum="+this.pageNum+"&pageSize="+this.pageSize)
          .then(res=>res.json())
          .then(res=>{
            console.log(res)
            this.tableData=res.data
            this.total=res.total
          })
    },
    handleSizeChange(pageSize){
      console.log(pageSize);
      //将获取到用户选择的数值进行复制
      this.pageSize=pageSize
      //获取到对应的页码时要进行数据请求
      this.load()
    },
    handleCurrentChange(pageNum){
      console.log(pageNum)
      //将获取到用户选择的数值进行复制
      this.pageNum=pageNum
      //获取到对应的页码时要进行数据请求
      this.load()
    },
  }
}
</script>
```

### 3.用户输入的模糊查询























